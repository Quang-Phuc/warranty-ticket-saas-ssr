<!-- src/app/features/shell/layout/app-shell/app-shell.component.html -->
<div class="shell" [class.is-collapsed]="collapsed()" [attr.data-theme]="theme()">
  <aside class="sidebar">
    <div class="brand">
      <button class="icon-btn" type="button" (click)="toggleCollapsed()" aria-label="Toggle sidebar">
        <span class="i">☰</span>
      </button>

      <div class="brand-text" *ngIf="!collapsed()">
        <div class="title">WarrantyPro</div>
        <div class="sub">Warranty & Ticket SaaS</div>
      </div>

      <div class="spacer"></div>

    </div>

    <div class="nav">
      <ng-container *ngFor="let g of navGroups()">
        <div class="group">
          <div class="group-title" *ngIf="!collapsed()">{{ g.label }}</div>

          <div class="items">
            <ng-container *ngFor="let item of g.items">
              <div class="item-wrap" [class.has-children]="(item.children?.length ?? 0) > 0">
                <a
                  class="item"
                  [class.expanded]="isOpen(item.id)"
                  [class.is-parent]="(item.children?.length ?? 0) > 0"
                  [routerLink]="item.route || null"
                  routerLinkActive="active"
                  [routerLinkActiveOptions]="{ exact: true }"
                  (click)="onItemClick($event, item)"
                  [attr.title]="collapsed() ? item.label : null"
                >
                  <span class="icon">{{ item.icon || '•' }}</span>

                  <span class="label" *ngIf="!collapsed()">{{ item.label }}</span>

                  <span class="badge" *ngIf="!collapsed() && item.badge">{{ item.badge }}</span>

                  <span class="chev" *ngIf="!collapsed() && (item.children?.length ?? 0) > 0">▾</span>
                </a>

                <div
                  class="children"
                  *ngIf="(item.children?.length ?? 0) > 0 && !collapsed()"
                  [class.open]="isOpen(item.id)"
                  [style.maxHeight.px]="isOpen(item.id) ? calcChildrenHeight(item.children?.length ?? 0) : 0"
                >
                  <a
                    class="child"
                    *ngFor="let c of item.children || []"
                    [routerLink]="c.route || null"
                    routerLinkActive="active"
                    [routerLinkActiveOptions]="{ exact: true }"
                  >
                    <span class="dot"></span>
                    <span class="label">{{ c.label }}</span>
                    <span class="mini" *ngIf="c.badge">{{ c.badge }}</span>
                  </a>
                </div>
              </div>
            </ng-container>
          </div>
        </div>
      </ng-container>
    </div>

    <div class="bottom">
      <button class="logout" type="button" (click)="logout()">
        <span class="i">⎋</span>
        <span class="t" *ngIf="!collapsed()">Đăng xuất</span>
      </button>
    </div>
  </aside>

  <main class="content">
    <div class="content-inner">
      <router-outlet></router-outlet>
    </div>
  </main>
</div>
