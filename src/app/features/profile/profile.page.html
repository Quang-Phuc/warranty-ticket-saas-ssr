<div class="profile-wrap">
    <div class="card">
        <div class="head">
            <div>
                <div class="title">Th√¥ng tin c√° nh√¢n</div>
                <div class="desc">Ch·ªânh s·ª≠a th√¥ng tin hi·ªÉn th·ªã tr√™n h·ªá th·ªëng</div>
            </div>

            <div class="avatar-zone">
                <div class="avatar">
                    <img *ngIf="avatarPreview()" [src]="avatarPreview()!" alt="avatar" />
                    <div class="fallback" *ngIf="!avatarPreview()">
                        {{ initials() }}
                    </div>
                </div>

                <label class="upload">
                    ƒê·ªïi ·∫£nh
                    <input
                            type="file"
                            accept="image/*"
                            hidden
                            (change)="onAvatarFileChange($event)"
                    />
                </label>
            </div>
        </div>

        <form [formGroup]="form" (ngSubmit)="save()">
            <div class="grid">
                <label>
                    <span>H·ªç t√™n *</span>
                    <input class="field" formControlName="fullName" placeholder="Nguy·ªÖn VƒÉn A" />
                </label>

                <label>
                    <span>Email</span>
                    <input class="field" formControlName="email" placeholder="email@domain.com" />
                </label>

                <label>
                    <span>S·ªë ƒëi·ªán tho·∫°i</span>
                    <input class="field" formControlName="phone" placeholder="09xxxxxxxx" />
                </label>

                <label>
                    <span>Ng√†nh ngh·ªÅ</span>
                    <input class="field" formControlName="industry" placeholder="Gara / ƒêi·ªán tho·∫°i / ƒêi·ªán l·∫°nh..." />
                </label>

                <label class="full">
                    <span>M√¥ t·∫£</span>
                    <textarea class="field area" formControlName="description"></textarea>
                </label>

                <label class="full">
                    <span>Website</span>
                    <input class="field" formControlName="website" placeholder="https://..." />
                </label>
            </div>

            <section class="section">
                <div class="section-head">
                    <div>
                        <div class="stitle">ƒê·ªãa ch·ªâ (nhi·ªÅu chi nh√°nh)</div>
                        <div class="sdesc">
                            G√µ ƒë·ªãa ch·ªâ ƒë·ªÉ autocomplete, ch·ªçn s·∫Ω zoom map. Click map s·∫Ω t·ª± fill ƒë·ªãa ch·ªâ.
                        </div>
                    </div>
                    <button class="add" type="button" (click)="addAddress()">+ Th√™m ƒë·ªãa ch·ªâ</button>
                </div>

                <div class="addr-list">
                    <div
                            class="addr"
                            *ngFor="let a of addresses().controls; let i = index"
                            [formGroup]="a"
                    >
                        <div class="addr-grid">
                            <label>
                                <span>T√™n chi nh√°nh *</span>
                                <input class="field" formControlName="name" placeholder="VD: Chi nh√°nh Qu·∫≠n 5" />
                            </label>

                            <button class="remove" type="button" (click)="removeAddress(i)">√ó</button>

                            <label class="full">
                                <span>ƒê·ªãa ch·ªâ *</span>
                                <input
                                        class="field"
                                        formControlName="address"
                                        placeholder="VD: 12 Nguy·ªÖn Tr√£i, Q5, TP.HCM"
                                        (input)="onAddressInput(i)"
                                />

                                <div class="suggestions" *ngIf="addressSuggestions()[i]?.length">
                                    <div
                                            class="s-item"
                                            *ngFor="let s of addressSuggestions()[i]"
                                            (click)="selectSuggestion(i, s)"
                                    >
                                        {{ s.display_name }}
                                    </div>
                                </div>
                            </label>

                            <div class="coords">
                                <div><b>Lat:</b> {{ a.value.lat || '--' }}</div>
                                <div><b>Lng:</b> {{ a.value.lng || '--' }}</div>
                            </div>

                            <button class="map-btn" type="button" (click)="toggleMap(i)">
                                üìç {{ openedMapIndex() === i ? 'ƒê√≥ng b·∫£n ƒë·ªì' : 'Ch·ªçn tr√™n b·∫£n ƒë·ªì' }}
                            </button>
                        </div>

                        <div class="map-wrap" *ngIf="openedMapIndex() === i">
                            <div class="map" [id]="'map-' + i"></div>
                            <div class="hint">üëâ Click map ƒë·ªÉ ch·ªçn v·ªã tr√≠.</div>
                        </div>
                    </div>
                </div>
            </section>

            <div class="actions">
                <button type="button" class="ghost" (click)="reset()">Ho√†n t√°c</button>
                <button type="submit" [disabled]="saving()">
                    {{ saving() ? 'ƒêang l∆∞u...' : 'L∆∞u thay ƒë·ªïi' }}
                </button>
            </div>

            <div class="msg" *ngIf="message()">{{ message() }}</div>
        </form>
    </div>
</div>
