<div class="upload">
    <input
        #fileInput
        type="file"
        [attr.accept]="accept()"
        [attr.multiple]="mode() === 'files' || mode() === 'images' ? '' : null"
        [disabled]="disabled()"
        hidden
        (change)="onPick(fileInput)"
    />

    <button class="pick-btn" type="button" (click)="fileInput.click()" [disabled]="disabled()">
        <span class="icon">⬆</span>
        <span>Chọn {{ mode().includes('image') ? 'ảnh' : 'file' }}</span>
    </button>

    <!-- ✅ IMAGE MODE -->
    <div class="thumbs" *ngIf="previews().length">
        <div class="thumb" *ngFor="let url of previews(); let i = index">
            <img [src]="url" />
            <button class="remove" type="button" (click)="removeAt(i)" [disabled]="disabled()">
                ✕
            </button>
        </div>
    </div>

    <!-- ✅ FILE MODE -->
    <div class="files" *ngIf="!previews().length && (singleFile() || multiFiles().length)">
        <div class="file" *ngIf="singleFile()">
            <span class="name" [title]="singleFile()?.name">{{ singleFile()?.name }}</span>
            <button class="remove" type="button" (click)="removeAt(0)" [disabled]="disabled()">
                ✕
            </button>
        </div>

        <div class="file" *ngFor="let f of multiFiles(); let i = index">
            <span class="name" [title]="f.name">{{ f.name }}</span>
            <button class="remove" type="button" (click)="removeAt(i)" [disabled]="disabled()">
                ✕
            </button>
        </div>
    </div>
</div>
